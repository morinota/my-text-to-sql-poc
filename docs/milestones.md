# マイルストーンリスト

このファイルは、Text-to-SQL PoCプロジェクトのマイルストーンを追跡するためのものです。各ステップが完了するごとにチェックボックスにチェックを入れて、進捗を管理します。

- (ちなみにマイルストーンとは?)
  - **プロジェクトやタスクを進める際の「重要な節目」や「達成ポイント」**を指す。
  - 各マイルストーンには、特定の目標や完了条件が設定されており、それを達成することでプロジェクトの進捗を確認できる。
  - 目的:
    - 進捗管理
    - 目標の明確化
    - チームの共通認識の形成
    - リスク管理

## マイルストーン（PoC向け最小限構成）

- [x] **1. プロジェクトの目標と範囲の定義**
  - [x] Text-to-SQLアプリケーションの目標を定義する（ユーザーの質問を受け取り、SQLクエリを生成）。
  - [x] 使用するデータベースの選定（簡単な構成のSQLiteまたはPostgreSQLに限定）。

- [x] **2. 開発環境の構築**
  - [x] 必要なソフトウェアとPythonライブラリ（例：OpenAI API、LangChainなど）をインストール。
  - [x] シンプルなサンプルデータベースをセットアップし、PoC用データをロード。

- [x] **第一フェーズ**: Text-to-SQLのPoC実装
  - [x] 基本的なText-to-SQL変換機能の実装
  - [x] OpenAI APIを利用した自然言語からSQLへの変換
  - [x] SQLiteの簡易データベース構築（サンプルデータを利用）
  - [x] コマンドラインインターフェース（CLI）での動作確認
  - [x] `loguru`でのロギング設定
  - [x] SQLのフォーマット機能（`sqlfluff`利用）

- [x] **第二フェーズ**: Text-to-SQLのサンプルクエリ対応とRAG（Retrieval Augmented Generation）のPoC準備
  - [x] Sakilaデータセットのダウンロードおよびインポートのスクリプト作成
  - [x] Sakilaデータセットに基づいたサンプルデータベースの構築
  - [x] 過去のサンプルクエリを`data/sample_queries/`ディレクトリに保存
    - 10個のクエリを`sample_query_{連番}.sql`形式で個別ファイルに分割保存
  - [x] **テーブルメタデータの用意**
    - 各テーブルの構造情報（テーブル名、カラム名、データ型）や概要（目的や内容の説明）の収集

- [x] **第三フェーズ**: RAGによる関連テーブル選択と高度なSQL生成
  - [x] **要約生成バッチジョブの実装**
    - テーブルとサンプルクエリの要約を生成し、JSONファイルまたはデータベースに保存
  - [x] **埋め込み生成バッチジョブの実装**
    - 要約データから埋め込み（embedding）を作成し、ベクトルストアまたはインデックスに保存
  - [x] **類似検索用のベクトルインデックス構築**
    - テーブル選択と過去クエリの検索のためのベクトルインデックスを構築
  - [x] ユーザクエリを受け取った時のRAG機能の実装
    - [x] テーブル選択のための類似検索機能の実装
    - [x] 選択されたテーブルに基づいたSQLクエリの生成
  - [x] PoC環境でのRAG機能の動作確認

- [ ] **最終フェーズ**: フィードバック収集と改善
  - [ ] **StreamlitによるGUIの構築**
    - [ ] 既存のCLIアプリケーションをGUIから操作できるようにする
    - [ ] Streamlitで入力フィールド、ボタン、選択ボックスなどのGUI要素を追加し、各CLIアプリケーションのパラメータを設定できるようにする
  - [ ] **GUIからの各機能のテストと動作確認**
    - [ ]　`generate_sql_query_ver2` の実行結果が正しく表示されることを確認
    - [ ] `embed_summaries_batch` や `generate_summaries_batch` などのオフラインバッチ処理がGUIから実行できることを確認
  - [ ] **ユーザーフィードバック収集の仕組みを追加**
    - [ ] 実行したクエリや結果に対するユーザーフィードバックを収集できる入力欄の追加
  - [ ] **クエリ検証機能の実装**
    - [ ] SQL生成クエリの検証機能を追加し、エラーの有無や構文の問題を通知
  - [ ] **実運用を視野に入れた最適化**
    - [ ] レスポンスの速度改善、コスト削減などの調整
    - [ ] 環境設定の柔軟性向上（設定ファイルでのモデル選択や埋め込み生成モデルの指定など）

---

各マイルストーンが完了するごとに進捗を確認し、プロジェクトの全体像を見渡せるようにします。
