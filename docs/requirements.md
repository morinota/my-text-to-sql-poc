# プロジェクト要件定義

## プロジェクト名

Text-to-SQL PoC

## プロジェクト概要

本プロジェクトは、自然言語での質問からSQLクエリを生成するText-to-SQLアプリケーションのPoC（概念実証）を目的としています。ユーザーがデータベースのスキーマを考慮しながらSQLを書かずに質問できるCLIアプリケーションを提供します。

## 目的

- データベースに対する自然言語の質問をSQLクエリに自動変換する機能をCLIで提供する。
- 生成されたSQLクエリが正確で、ユーザーの意図に沿っていることを確認する。

## 要件

### 機能要件
>
> システムが提供すべき具体的な機能や操作に関する要件。

1. **自然言語入力**:
   - CLI上でユーザーが自然言語で質問を入力できること。
   - 例: 「2023年の売上合計は？」などの質問を入力プロンプトで受け付ける。

2. **SQLクエリ生成**:
   - LLM（大規模言語モデル）を使用し、自然言語からSQLクエリを生成する。
   - 基本的なクエリ（SELECT文、WHERE句、GROUP BYなど）に対応する。

3. **SQLiteスキーマの取得と活用**:
   - SQLiteデータベースからテーブルやカラムの情報を取得し、SQL生成時にプロンプトへ追加する。
   - スキーマ情報がプロンプト内に含まれることで、LLMが正確なSQLを生成できるようにする。

4. **CLIインターフェースでの出力**:
   - 生成されたSQLクエリをCLI上で表示し、ユーザーが確認できるようにする。
   - 必要に応じて、生成されたクエリを実行し、結果を表示するオプションも提供する。

5. **基本的なRAGプロセス（ベクトル検索）**:
   - 類似度検索を利用して、ユーザー質問に関連するテーブルを提案する機能。
   - 初期段階では簡易的なベクトルインデックスを用い、関連するテーブルを選択。

6. **テストと評価**:
   - 生成されたSQLクエリが期待通りに動作するかをテストする。
   - PoCとしての目的を満たすか、正確性や効率性について評価を行う。

### 非機能要件
>
> システムのパフォーマンスやメンテナンス性、使いやすさなどに関する要件。

1. **応答速度**:
   - LLMやSQLiteアクセスにかかる時間が短く、CLIでの応答がスムーズに行えること。
   - 応答時間の目安: 数秒〜10秒以内。

2. **メンテナンス性**:
   - コードや設定がわかりやすく、機能の追加や変更が容易であること。
   - 使用するライブラリやツールのバージョン管理をPoetryで一元化する。

## スコープ

- 本PoCでは、CLIアプリケーションとして実装し、SQLiteに限定して、基礎的なSQL文生成の検証に焦点を当てる。
- 本番環境での使用を前提とした高度な最適化やGUIインターフェースは対象外とする。

## 将来的な展望

- 将来的には、Streamlitを使用してSnowflake上での実装を検討している。これにより、ユーザーに対してよりリッチなインターフェースを提供し、データの視覚化やインタラクティブな分析が可能となる。

- 本PoCを通じて得られた知見をもとに、機能の拡張やユーザーインターフェースの導入などの次のステップを検討する。
- ユーザーの意図をより正確に反映する高度なクエリ生成や、RAGプロセスの精度向上などの改善点を計画する。
